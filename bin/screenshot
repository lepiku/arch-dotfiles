#!/bin/sh

source ~/.config/script.conf
: '
$screenshot_image_dir
$screenshot_image_dir_temp
'

args=" ${@:2} "
image_name="$(date +%F_%H-%M-%S-%N | cut -c -23).png"

_maim() {
    case $args in
        *" --save "* | *" -s "*) image_path="$screenshot_image_dir/$image_name";;
        *) image_path="$screenshot_image_dir_temp/$image_name";;
    esac

    maim $* $image_path &&
        xclip -selection clipboard -t image/png $image_path
}

case $1 in
    screen)
        _maim
        ;;
    select)
        _maim -su
        ;;
    clean)
        echo "Removing temp images in $screenshot_image_dir_temp"
        rm $screenshot_image_dir_temp/*
        ;;
    *)
        echo "Unknown command: $1"
esac
