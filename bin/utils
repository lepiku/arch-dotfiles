#!/bin/sh

source ~/.config/dotfiles.conf
: '
$utils_notif_id
$utils_brightness_delta
$utils_network_ethernet_interface
$utils_network_ethernet_max
$utils_network_wifi_interface
$utils_network_wifi_max
'

app_name="utils"
args=" ${@:2} "

_notify() {
    message="$1"
    icon="$2"

    notif_id=`
    notify-send -u low -a $app_name -t 1000 -r "$utils_notif_id" \
        "$message"`
    }

    case $1 in
        brightness)
            case $2 in
                increase)
                    ddcutil --bus 6 setvcp 10 + $utils_brightness_delta
                    value=`ddcutil --bus 6 getvcp 10 | sed 's/.*current value = *//;s/,.*//'`
                    _notify "Brightness: $value%"
                    ;;
                decrease)
                    ddcutil --bus 6 setvcp 10 - $utils_brightness_delta
                    value=`ddcutil --bus 6 getvcp 10 | sed ';s/.*current value = *//;s/,.*//'`
                    _notify "Brightness: $value%"
                    ;;
                *)
                    _notify "Unknown brightness command: $2"
            esac
            ;;

        network)
            case $2 in
                ethernet)
                    speedometer \
                        -r $utils_network_ethernet_interface \
                        -t $utils_network_ethernet_interface \
                        -l -m $utils_network_ethernet_max
                        ;;
                wifi)
                    speedometer \
                        -r $utils_network_wifi_interface \
                        -t $utils_network_wifi_interface \
                        -l -m $utils_network_wifi_max
                        ;;
            esac
            ;;
        *)
            _notify "Unknown command: $1"
    esac
